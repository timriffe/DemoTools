% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_downloads.R
\name{downloadAsfr}
\alias{downloadAsfr}
\title{Download or Process Age-Specific Fertility Rates (ASFR)}
\usage{
downloadAsfr(
  Asfrmat = NULL,
  location = NULL,
  AsfrDatesIn = NULL,
  Age = NULL,
  method = "linear",
  output = "5-year",
  ...
)
}
\arguments{
\item{Asfrmat}{Optional numeric matrix or data frame of ASFR values (rows = ages, columns = years).}

\item{location}{Character or numeric code specifying the country/region to download ASFR for.}

\item{AsfrDatesIn}{Numeric vector of years to interpolate or extract ASFR for.}

\item{Age}{Optional numeric vector of ages corresponding to rows of \code{Asfrmat}.}

\item{method}{Character specifying interpolation method for \code{interp()} (default = "linear").}

\item{output}{Character specifying age structure of output: \code{"single"} (single-year) or \code{"5-year"} (default).}

\item{...}{Additional arguments passed to the interpolation function \code{interp()}.}
}
\value{
A numeric matrix of ASFR values:
\itemize{
\item Rows: age groups (single-year or 5-year bins)
\item Columns: years (\code{AsfrDatesIn})
}
}
\description{
This function either returns user-supplied ASFR data formatted to a specific age
structure or downloads and constructs ASFR values from the most recent installed
\code{wpp} package for a given location. It supports interpolation across years
and aggregation to 5-year age groups.
}
\details{
When \code{Asfrmat} is supplied, the function:
\enumerate{
\item Converts it to a matrix (if needed),
\item Assigns row names (ages) and column names (years),
\item Returns the formatted ASFR matrix.
}

When \code{Asfrmat} is not supplied, the function:
\enumerate{
\item Finds the latest installed \code{wpp} package (>= 2022 for single-year data),
\item Loads \code{percentASFR1dt} and \code{tfr1} datasets,
\item Constructs ASFR for single-year or 5-year age groups,
\item Interpolates ASFR across requested years \code{AsfrDatesIn} using \code{interp()}.
}

For single-year output, ASFR is calculated by multiplying the percentage ASFR
from WPP by TFR and interpolating to requested years. For 5-year output, percentages
are aggregated into 5-year bins before multiplying by TFR and interpolating.
If \code{Asfrmat} is supplied by the user, it is returned after formatting.
}
\examples{
# Using user-supplied ASFR matrix
ASFR_user <- matrix(runif(5*3), nrow = 5, ncol = 3)
rownames(ASFR_user) <- c(15, 20, 25, 30, 35)
colnames(ASFR_user) <- c(2000, 2005, 2010)
ASFR_mat <-  downloadAsfr(Asfrmat = ASFR_user)

# Download single-year ASFR for Argentina
ASFR_Arg <- downloadAsfr(
  Asfrmat = NULL,
  location = "Argentina",
  AsfrDatesIn = 1950:1960,
  method = "linear",
  output = "single"
)

ASFR_Arg1 <- downloadAsfr(
 Asfrmat     = NULL,
 location    = "Argentina",
 AsfrDatesIn = 1950:1960,
 method      = "linear",
 output      = "single"
)


ASFR_Arg2 <- downloadAsfr(
 Asfrmat     = NULL,
 location    = "Argentina",
 AsfrDatesIn = 1950:1963,
 method      = "linear",
 output      = "5-year"
)
}
\seealso{
\code{\link{interp}},
\code{\link{graduate_pclm}}
}
