<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extrapolate old-age human mortality curve using mortality laws — lt_rule_m_extrapolate • DemoTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extrapolate old-age human mortality curve using mortality laws — lt_rule_m_extrapolate" />
<meta property="og:description" content="Extrapolate old-age human mortality curve using mortality laws" />
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-reverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">01.13.75</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Short manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Handle age heaping</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduate demographic counts</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smooth demographic counts</a>
    </li>
    <li>
      <a href="../articles/lifetables_with_demotools.html">Construct a lifetable</a>
    </li>
    <li>
      <a href="../articles/migration_with_demotools.html">Model migration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/case_study_1.html">Case study</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/timriffe1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/timriffe/DemoTools/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extrapolate old-age human mortality curve using mortality laws</h1>
    <small class="dont-index">Source: <a href='https://github.com/timriffe/DemoTools/blob/master/R/extra_mortality.R'><code>R/extra_mortality.R</code></a></small>
    <div class="hidden name"><code>lt_rule_m_extrapolate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extrapolate old-age human mortality curve using mortality laws</p>
    </div>

    <pre class="usage"><span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span>
  <span class='va'>mx</span>,
  <span class='va'>x</span>,
  x_fit <span class='op'>=</span> <span class='va'>x</span>,
  <span class='va'>x_extr</span>,
  law <span class='op'>=</span> <span class='st'>"kannisto"</span>,
  opt.method <span class='op'>=</span> <span class='st'>"LF2"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mx</th>
      <td><p>Vector or matrix of age specific death-rates.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Vector of ages at the beginning of the age interval.</p></td>
    </tr>
    <tr>
      <th>x_fit</th>
      <td><p>Ages to be considered in estimating the mortality model parameters.
<code>x_fit</code> can be a subset of <code>x</code>. However, after the model is identifies
fitted values and residuals are computed for all ages in <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>x_extr</th>
      <td><p>Ages for which to extrapolate the death-rates.</p></td>
    </tr>
    <tr>
      <th>law</th>
      <td><p>The name of the mortality law/model to be used.
The following options are available:</p><ul>
<li><p><code>"kannisto"</code> -- The Kannisto model;</p></li>
<li><p><code>"kannisto_makeham"</code> -- The Kannisto-Makeham model;</p></li>
<li><p><code>"gompertz"</code> -- The Gompertz model;</p></li>
<li><p><code>"ggompertz"</code> -- The Gamma-Gompertz model;</p></li>
<li><p><code>"makeham"</code> -- The Makeham model;</p></li>
<li><p><code>"beard"</code> -- The Beard model;</p></li>
<li><p><code>"beard_makeham"</code> -- The Beard-Makeham model;</p></li>
<li><p><code>"quadratic"</code> -- The Quadratic model.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>opt.method</th>
      <td><p>character. Default <code>"LF2"</code>, see <code><a href='https://rdrr.io/pkg/MortalityLaws/man/MortalityLaw.html'>MortalityLaws::MortalityLaw</a></code> for a description of choices.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to be passed on to the
<code><a href='https://rdrr.io/pkg/MortalityLaws/man/MortalityLaw.html'>MortalityLaw</a></code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>lt_rule_m_extrapolate</code> with the following components:</p>
<dt>input</dt><dd><p>List with arguments provided in input. Saved for convenience.</p></dd>
<dt>call</dt><dd><p>An unevaluated function call, that is, an unevaluated expression that consists of the named function applied to the given arguments.</p></dd>
<dt>fitted.model</dt><dd><p>An object of class <code><a href='https://rdrr.io/pkg/MortalityLaws/man/MortalityLaw.html'>MortalityLaw</a></code>. Here one can find fitted values, residuals, goodness of fit measures etc.</p></dd>
<dt>values</dt><dd><p>A vector or matrix containing the complete mortality data, that is the modified input data following the extrapolation procedure.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If fitting fails to converge, then we refit assuming Gompertz mortality with explicit starting parameters of <code>parS = c(A = 0.005, B = 0.13)</code> and a warning is issued.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/MortalityLaws/man/MortalityLaw.html'>MortalityLaw</a></code>
<code><a href='https://rdrr.io/pkg/MortalityLaws/man/predict.MortalityLaw.html'>predict.MortalityLaw</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marius D. Pascariu <a href='mailto:rpascariu@outlook.com'>rpascariu@outlook.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># Example 1 - abridged data</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Age-specific death rates</span></span>
<span class='r-in'><span class='va'>mx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.0859</span>, <span class='fl'>.0034</span>, <span class='fl'>.0009</span>, <span class='fl'>.0007</span>, <span class='fl'>.0016</span>, <span class='fl'>.0029</span>, <span class='fl'>.0036</span>, <span class='fl'>.0054</span>,</span>
<span class='r-in'>        <span class='fl'>.0053</span>, <span class='fl'>.0146</span>, <span class='fl'>.0127</span>, <span class='fl'>.0269</span>, <span class='fl'>.0170</span>, <span class='fl'>.0433</span>, <span class='fl'>.0371</span>, <span class='fl'>.0784</span>,</span>
<span class='r-in'>        <span class='fl'>.0930</span>, <span class='fl'>.1399</span>, <span class='fl'>.1875</span>, <span class='fl'>.2250</span>, <span class='fl'>.2500</span>, <span class='fl'>.3000</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Vector of ages</span></span>
<span class='r-in'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>100</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>mx</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>x</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Fit the models / Extrapolate the mortality curve</span></span>
<span class='r-in'><span class='va'>x_fit</span>  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>85</span>, <span class='fl'>90</span>, <span class='fl'>95</span>, <span class='fl'>100</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x_extr</span> <span class='op'>=</span> <span class='fl'>90</span><span class='op'>:</span><span class='fl'>110</span></span>
<span class='r-in'><span class='va'>f1</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"kannisto"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f2</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"kannisto_makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f3</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"gompertz"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f4</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"ggompertz"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f5</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f6</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"beard"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f7</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"beard_makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>f8</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx</span>, <span class='va'>x</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"quadratic"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot the results</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>mx</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>, <span class='fl'>110</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.6</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x_fit</span>, <span class='va'>mx</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span><span class='op'>]</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='fl'>4</span>, cex <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f1</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>1</span>, col <span class='op'>=</span> <span class='fl'>2</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f2</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='fl'>3</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f3</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>3</span>, col <span class='op'>=</span> <span class='fl'>4</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f4</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>4</span>, col <span class='op'>=</span> <span class='fl'>5</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f5</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>5</span>, col <span class='op'>=</span> <span class='fl'>6</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f6</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>6</span>, col <span class='op'>=</span> <span class='fl'>7</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f7</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>7</span>, col <span class='op'>=</span> <span class='fl'>8</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>f8</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>8</span>, col <span class='op'>=</span> <span class='fl'>9</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>, bty <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span class='r-in'>       legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Obs. Values"</span>, <span class='st'>"Obs. Values used in fitting"</span>,</span>
<span class='r-in'>                  <span class='st'>"Kannisto"</span>, <span class='st'>"Kannisto-Makeham"</span>, <span class='st'>"Gompertz"</span>, <span class='st'>"Gamma-Gompertz"</span>,</span>
<span class='r-in'>                  <span class='st'>"Makeham"</span>, <span class='st'>"Beard"</span>, <span class='st'>"Beard-Makeham"</span>, <span class='st'>"Quadratic"</span><span class='op'>)</span>,</span>
<span class='r-in'>       lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>16</span>, <span class='fl'>16</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>)</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, pt.cex <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ----------------------------------------------</span></span>
<span class='r-in'><span class='co'># Example 2 - 1-year age data</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Age-specific death rates</span></span>
<span class='r-in'><span class='va'>mx1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.0070</span>, <span class='fl'>.0082</span>, <span class='fl'>.0091</span>, <span class='fl'>.0096</span>, <span class='fl'>.0108</span>, <span class='fl'>.0122</span>, <span class='fl'>.0141</span>, <span class='fl'>.0150</span>, <span class='fl'>.0165</span>, <span class='fl'>.0186</span>,</span>
<span class='r-in'>         <span class='fl'>.0205</span>, <span class='fl'>.0229</span>, <span class='fl'>.0259</span>, <span class='fl'>.0294</span>, <span class='fl'>.0334</span>, <span class='fl'>.0379</span>, <span class='fl'>.0426</span>, <span class='fl'>.0482</span>, <span class='fl'>.0550</span>, <span class='fl'>.0628</span>,</span>
<span class='r-in'>         <span class='fl'>.0716</span>, <span class='fl'>.0806</span>, <span class='fl'>.0897</span>, <span class='fl'>.1003</span>, <span class='fl'>.1149</span>, <span class='fl'>.1264</span>, <span class='fl'>.1558</span>, <span class='fl'>.1563</span>, <span class='fl'>.1812</span>, <span class='fl'>.2084</span>,</span>
<span class='r-in'>         <span class='fl'>.2298</span>, <span class='fl'>.2536</span>, <span class='fl'>.2813</span>, <span class='fl'>.3143</span>, <span class='fl'>.3352</span>, <span class='fl'>.3651</span>, <span class='fl'>.4128</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Vector of ages</span></span>
<span class='r-in'><span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>65</span><span class='op'>:</span><span class='fl'>101</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>mx1</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>x1</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Fit the models / Extrapolate the mortality curve</span></span>
<span class='r-in'><span class='va'>x_fit</span> <span class='op'>=</span> <span class='fl'>80</span><span class='op'>:</span><span class='fl'>95</span></span>
<span class='r-in'><span class='va'>x_extr</span> <span class='op'>=</span> <span class='fl'>80</span><span class='op'>:</span><span class='fl'>125</span></span>
<span class='r-in'><span class='va'>g1</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"kannisto"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g2</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"kannisto_makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g3</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"gompertz"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g4</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"ggompertz"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g5</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g6</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"beard"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g7</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"beard_makeham"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>g8</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx1</span>, <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"quadratic"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>mx1</span>, log <span class='op'>=</span> <span class='st'>"y"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.001</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>     pch <span class='op'>=</span> <span class='fl'>16</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>65</span>, <span class='fl'>125</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x_fit</span>, <span class='va'>mx1</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span><span class='op'>]</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='fl'>4</span>, cex <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g1</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>1</span>, col <span class='op'>=</span> <span class='fl'>2</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g2</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='fl'>3</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g3</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>3</span>, col <span class='op'>=</span> <span class='fl'>4</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g4</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>4</span>, col <span class='op'>=</span> <span class='fl'>5</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g5</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>5</span>, col <span class='op'>=</span> <span class='fl'>6</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g6</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>6</span>, col <span class='op'>=</span> <span class='fl'>7</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g7</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>7</span>, col <span class='op'>=</span> <span class='fl'>8</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>x_extr</span>, <span class='va'>g8</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x_extr</span><span class='op'>)</span><span class='op'>]</span>, lty <span class='op'>=</span> <span class='fl'>8</span>, col <span class='op'>=</span> <span class='fl'>9</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>, bty <span class='op'>=</span> <span class='st'>"n"</span>,</span>
<span class='r-in'>       legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Obs. Values"</span>, <span class='st'>"Obs. Values used in fitting"</span>,</span>
<span class='r-in'>                  <span class='st'>"Kannisto"</span>, <span class='st'>"Kannisto-Makeham"</span>, <span class='st'>"Gompertz"</span>, <span class='st'>"Gamma-Gompertz"</span>,</span>
<span class='r-in'>                  <span class='st'>"Makeham"</span>, <span class='st'>"Beard"</span>, <span class='st'>"Beard-Makeham"</span>, <span class='st'>"Quadratic"</span><span class='op'>)</span>,</span>
<span class='r-in'>       lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>16</span>, <span class='fl'>16</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>)</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, pt.cex <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'><span class='co'># ----------------------------------------------</span></span>
<span class='r-in'><span class='co'># Example 3 - Extrapolate mortality for multiple years at once</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create some data</span></span>
<span class='r-in'><span class='va'>mx_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>mx1</span>, <span class='fl'>3</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1.05</span>, <span class='fl'>1.1</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>mx_matrix</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='va'>x1</span>, year <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"year1"</span>, <span class='st'>"year2"</span>, <span class='st'>"year3"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>F1</span> <span class='op'>&lt;-</span> <span class='fu'>lt_rule_m_extrapolate</span><span class='op'>(</span><span class='va'>mx_matrix</span>, x <span class='op'>=</span> <span class='va'>x1</span>, <span class='va'>x_fit</span>, <span class='va'>x_extr</span>, law <span class='op'>=</span> <span class='st'>"kannisto"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>the condition has length &gt; 1 and only the first element will be used</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = c(A = 0.005, B = 0.13))</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>the condition has length &gt; 1 and only the first element will be used</span>
<span class='r-in'><span class='va'>F1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$opt.choices</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "poissonL"  "LF2"       "LF1"       "LF3"       "LF4"       "LF5"      </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [7] "LF6"       "binomialL"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$all_the_laws_we_care_about</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "kannisto"         "kannisto_makeham" "makeham"          "gompertz"        </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [5] "ggompertz"        "beard"            "beard_makeham"    "quadratic"       </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$mx</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      year</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> age    year1    year2   year3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   65  0.0070 0.007350 0.00770</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   66  0.0082 0.008610 0.00902</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   67  0.0091 0.009555 0.01001</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   68  0.0096 0.010080 0.01056</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   69  0.0108 0.011340 0.01188</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   70  0.0122 0.012810 0.01342</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   71  0.0141 0.014805 0.01551</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   72  0.0150 0.015750 0.01650</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   73  0.0165 0.017325 0.01815</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   74  0.0186 0.019530 0.02046</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   75  0.0205 0.021525 0.02255</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   76  0.0229 0.024045 0.02519</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   77  0.0259 0.027195 0.02849</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   78  0.0294 0.030870 0.03234</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   79  0.0334 0.035070 0.03674</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   80  0.0379 0.039795 0.04169</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   81  0.0426 0.044730 0.04686</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   82  0.0482 0.050610 0.05302</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   83  0.0550 0.057750 0.06050</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   84  0.0628 0.065940 0.06908</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   85  0.0716 0.075180 0.07876</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   86  0.0806 0.084630 0.08866</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   87  0.0897 0.094185 0.09867</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   88  0.1003 0.105315 0.11033</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   89  0.1149 0.120645 0.12639</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   90  0.1264 0.132720 0.13904</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   91  0.1558 0.163590 0.17138</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   92  0.1563 0.164115 0.17193</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   93  0.1812 0.190260 0.19932</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   94  0.2084 0.218820 0.22924</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   95  0.2298 0.241290 0.25278</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   96  0.2536 0.266280 0.27896</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   97  0.2813 0.295365 0.30943</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   98  0.3143 0.330015 0.34573</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   99  0.3352 0.351960 0.36872</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   100 0.3651 0.383355 0.40161</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   101 0.4128 0.433440 0.45408</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$x</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1]  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [20]  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$x_fit</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$x_extr</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1]  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [20]  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [39] 118 119 120 121 122 123 124 125</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$law</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "kannisto"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $input$opt.method</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "LF2"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $call</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> lt_rule_m_extrapolate(mx = mx_matrix, x = x1, x_fit = x_fit, </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     x_extr = x_extr, law = "kannisto")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $fitted.model</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Gompertz model: mu[x] = A exp[Bx]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Fitted values: mx </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $values</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>          year1      year2      year3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 65  0.00700000 0.00735000 0.00770000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 66  0.00820000 0.00861000 0.00902000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 67  0.00910000 0.00955500 0.01001000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 68  0.00960000 0.01008000 0.01056000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 69  0.01080000 0.01134000 0.01188000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 70  0.01220000 0.01281000 0.01342000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 71  0.01410000 0.01480500 0.01551000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 72  0.01500000 0.01575000 0.01650000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 73  0.01650000 0.01732500 0.01815000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 74  0.01860000 0.01953000 0.02046000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 75  0.02050000 0.02152500 0.02255000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 76  0.02290000 0.02404500 0.02519000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 77  0.02590000 0.02719500 0.02849000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 78  0.02940000 0.03087000 0.03234000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 79  0.03340000 0.03507000 0.03674000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 80  0.03838151 0.04031258 0.04223348</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 81  0.04330236 0.04547856 0.04764595</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 82  0.04885409 0.05130656 0.05375207</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 83  0.05511761 0.05788141 0.06064072</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 84  0.06218416 0.06529881 0.06841219</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 85  0.07015671 0.07366674 0.07717962</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 86  0.07915140 0.08310700 0.08707064</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 87  0.08929929 0.09375702 0.09822927</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 88  0.10074823 0.10577182 0.11081793</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 89  0.11366503 0.11932629 0.12501991</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 90  0.12823786 0.13461775 0.14104196</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 91  0.14467906 0.15186877 0.15911733</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 92  0.16322817 0.17133049 0.17950917</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 93  0.18415543 0.19328619 0.20251434</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 94  0.20776574 0.21805548 0.22846777</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 95  0.23440310 0.24599891 0.25774727</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 96  0.26445560 0.27752324 0.29077913</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 97  0.29836109 0.31308736 0.32804421</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 98  0.33661356 0.35320895 0.37008503</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 99  0.37977032 0.39847206 0.41751364</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 100 0.42846015 0.44953556 0.47102051</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 101 0.48339244 0.50714275 0.53138460</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 102 0.54536752 0.57213221 0.59948471</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 103 0.61528834 0.64544995 0.67631225</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 104 0.69417362 0.72816323 0.76298571</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 105 0.78317267 0.82147607 0.86076688</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 106 0.88358216 0.92674679 0.97107930</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 107 0.99686501 1.04550777 1.09552891</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 108 1.12467171 1.17948776 1.23592749</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 109 1.26886433 1.33063705 1.39431898</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 110 1.43154368 1.50115586 1.57300928</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 111 1.61507993 1.69352636 1.77459982</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 112 1.82214711 1.91054879 2.00202538</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 113 2.05576209 2.15538228 2.25859689</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 114 2.31932853 2.43159074 2.54804957</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 115 2.61668646 2.74319484 2.87459735</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 116 2.95216824 3.09473045 3.24299417</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 117 3.33066168 3.49131474 3.65860324</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 118 3.75768124 3.93872061 4.12747509</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 119 4.23944840 4.44346077 4.65643568</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 120 4.78298226 5.01288248 5.25318572</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 121 5.39620185 5.65527460 5.92641285</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 122 6.08804148 6.37998813 6.68591805</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 123 6.86858093 7.19757244 7.54275838</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 124 7.74919226 8.11992875 8.50940792</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 125 8.74270557 9.16048340 9.59993937</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"class")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "lt_rule_m_extrapolate"</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='va'>F1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "call"         "fitted.model" "input"        "values"      </span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>F1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> NULL</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Riffe, José Manuel Aburto, Ilya Kashnitsky, Monica Alexander, Marius D. Pascariu, Sara Hertog, Sean Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


