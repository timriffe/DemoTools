<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Redistribute population over a specified age based on a stable standard fit to the data — OPAG • DemoTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Redistribute population over a specified age based on a stable standard fit to the data — OPAG" />
<meta property="og:description" content="This can be used as an external check of population counts
in older ages, assuming the stable population standard is representative enough, or it can be used to redistribute population in ages above a
specified ages Redistribute_from. This is handy, for instance, for
ensuring all censuses extend to a specified maximum age (e.g. 100+)
prior to intercensal interpolations. The assumption is that, at least in
ages including Age_fit and higher ages, the population should follow
a stable pattern proportional to a given survival curve subject to
constant growth, r." />
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-reverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">01.13.74</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Short manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Handle age heaping</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduate demographic counts</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smooth demographic counts</a>
    </li>
    <li>
      <a href="../articles/lifetables_with_demotools.html">Construct a lifetable</a>
    </li>
    <li>
      <a href="../articles/migration_with_demotools.html">Model migration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/case_study_1.html">Case study</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/timriffe1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/timriffe/DemoTools/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Redistribute population over a specified age based on a stable standard fit to the data</h1>
    <small class="dont-index">Source: <a href='https://github.com/timriffe/DemoTools/blob/master/R/OPAG.R'><code>R/OPAG.R</code></a></small>
    <div class="hidden name"><code>OPAG.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This can be used as an external check of population counts
in older ages, assuming the stable population standard is representative enough, or it can be used to redistribute population in ages above a
specified ages <code>Redistribute_from</code>. This is handy, for instance, for
ensuring all censuses extend to a specified maximum age (e.g. 100+)
prior to intercensal interpolations. The assumption is that, at least in
ages including <code>Age_fit</code> and higher ages, the population should follow
a stable pattern proportional to a given survival curve subject to
constant growth, <code>r</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>OPAG</span><span class='op'>(</span>
  <span class='va'>Pop</span>,
  <span class='va'>Age_Pop</span>,
  <span class='va'>nLx</span>,
  <span class='va'>Age_nLx</span>,
  Age_fit <span class='op'>=</span> <span class='cn'>NULL</span>,
  AgeInt_fit <span class='op'>=</span> <span class='cn'>NULL</span>,
  Redistribute_from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Age_Pop</span><span class='op'>)</span>,
  OAnew <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Age_nLx</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"mono"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Pop</th>
      <td><p>numeric vector of population counts</p></td>
    </tr>
    <tr>
      <th>Age_Pop</th>
      <td><p>integer vector of the lower bounds of the population age groups</p></td>
    </tr>
    <tr>
      <th>nLx</th>
      <td><p>numeric vector of stationary population age structure in arbitrary integer age groups</p></td>
    </tr>
    <tr>
      <th>Age_nLx</th>
      <td><p>integer vector of lower bounds of age groups of <code>nLx</code></p></td>
    </tr>
    <tr>
      <th>Age_fit</th>
      <td><p>integer vector of lower bounds for age groups of <code>Pop_fit</code></p></td>
    </tr>
    <tr>
      <th>AgeInt_fit</th>
      <td><p>integer vector of widths of age groups of <code>Pop_fit</code></p></td>
    </tr>
    <tr>
      <th>Redistribute_from</th>
      <td><p>integer lower age bound that forms the cutoff, above which we redistribute counts using the stable standard.</p></td>
    </tr>
    <tr>
      <th>OAnew</th>
      <td><p>integer. Desired open age group in the output (must being element of <code>Age_nLx</code>)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character, graduation method used for intermediate graduation. Default <code>"mono"</code>. Other reasonable choices include <code>"pclm"</code> or <code>"uniform"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It may be helpful to try more than one fitting possibility,
and more than one <code>Redistribute_from</code> cut point, as results may vary.</p>
<p><code>Redistribute_from</code> can be lower than your current open age group,
and <code>OAnew</code> can be higher, as long as it is within the range of <code>Age_nLx</code>.
If <code>Age_nLx</code> doesn't go high enough for your needs, you can extrapolate
it ahead of time. For this, you'd want the <code>nMx</code> the underlie it, and you
can use <code><a href='lt_abridged.html'>lt_abridged()</a></code>, specifying a higher open age, and then
extracting <code>nLx</code> again from it.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># India Males, 1971</span></span>
<span class='r-in'><span class='va'>Pop</span>            <span class='op'>&lt;-</span> <span class='fu'><a href='smooth_age_5.html'>smooth_age_5</a></span><span class='op'>(</span><span class='va'>pop1m_ind</span>,</span>
<span class='r-in'>                         Age <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>100</span>,</span>
<span class='r-in'>                         method <span class='op'>=</span> <span class='st'>"Arriaga"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Age_Pop</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>Pop</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>AgeInt_Pop</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='age2int.html'>age2int</a></span><span class='op'>(</span><span class='va'>Age_Pop</span>, OAvalue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>nLx</span>            <span class='op'>&lt;-</span> <span class='fu'><a href='downloadnLx.html'>downloadnLx</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"India"</span>,<span class='st'>"male"</span>,<span class='fl'>1971</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Downloading nLx data for India, years 1971, gender male</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Extrapolation failed to converge</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Falling back to Gompertz with starting parameters:</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span>  parS = nc(A = 0.005, B = 0.13))</span>
<span class='r-in'><span class='va'>Age_nLx</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>nLx</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>AgeInt_nLx</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='age2int.html'>age2int</a></span><span class='op'>(</span><span class='va'>Age_nLx</span>, OAvalue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>Pop_fit</span> <span class='op'>&lt;-</span> <span class='fu'>OPAG</span><span class='op'>(</span><span class='va'>Pop</span>,</span>
<span class='r-in'>    Age_Pop <span class='op'>=</span> <span class='va'>Age_Pop</span>,</span>
<span class='r-in'>    nLx <span class='op'>=</span> <span class='va'>nLx</span>,</span>
<span class='r-in'>    Age_nLx <span class='op'>=</span> <span class='va'>Age_nLx</span>,</span>
<span class='r-in'>    Age_fit <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>70</span><span class='op'>)</span>,</span>
<span class='r-in'>    AgeInt_fit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>    Redistribute_from <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Age_Pop and Age_nLx age intervals are different!</span>
<span class='r-in'></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='co'># look at 75+</span></span>
<span class='r-in'><span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='va'>Age_Pop</span> <span class='op'>&gt;=</span> <span class='fl'>75</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Age_Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span>, <span class='va'>Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>Age_Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span>, <span class='va'>Pop_fit</span><span class='op'>$</span><span class='va'>Pop_out</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># relative differences in ages 80+</span></span>
<span class='r-in'><span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='va'>Age_Pop</span> <span class='op'>&gt;=</span> <span class='fl'>80</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Age_Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span>,  <span class='op'>(</span><span class='va'>Pop_fit</span><span class='op'>$</span><span class='va'>Pop_out</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>Pop</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Riffe, José Manuel Aburto, Ilya Kashnitsky, Monica Alexander, Marius D. Pascariu, Sara Hertog, Sean Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


