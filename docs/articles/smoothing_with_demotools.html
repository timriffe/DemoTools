<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smoothing with DemoTools • DemoTools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Smoothing with DemoTools">
<meta property="og:description" content="DemoTools">
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-reverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">01.13.76</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Short manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Handle age heaping</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduate demographic counts</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smooth demographic counts</a>
    </li>
    <li>
      <a href="../articles/lifetables_with_demotools.html">Construct a lifetable</a>
    </li>
    <li>
      <a href="../articles/migration_with_demotools.html">Model migration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/case_study_1.html">Case study</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/timriffe1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/timriffe/DemoTools/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="smoothing_with_demotools_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Smoothing with DemoTools</h1>
                        <h4 class="author">Jose Manuel Aburto, Ilya Kashnitsky, Marius Pascariu, Tim Riffe</h4>
            
            <h4 class="date">2022-01-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/timriffe/DemoTools/blob/master/vignettes/smoothing_with_demotools.Rmd"><code>vignettes/smoothing_with_demotools.Rmd</code></a></small>
      <div class="hidden name"><code>smoothing_with_demotools.Rmd</code></div>

    </div>

    
    
<div id="how-to-use-demotools-to-smooth-population-counts" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-use-demotools-to-smooth-population-counts" class="anchor"></a>How to use <code>DemoTools</code> to smooth population counts</h2>
<p>Smoothing data over age is traditionally intended to have plausible/corrected estimates of population counts from census data. Smoothing procedures help to derive figures that are corrected primarily for net error by fitting different curves to the original 5 or 10-year totals, modifying the original counts <span class="citation">(Siegel Jacob and Swanson David 2004)</span>. Several methods have been developed for this aim and the major smoothing methods are included in <code>DemoTools</code>. Including the Carrier-Farrag <span class="citation">(Carrier and Farrag 1959)</span>, Arriaga <span class="citation">(Arriaga, Johnson, and Jamison 1994)</span>, Karup-King-Newton, United Stations <span class="citation">(United Nations 1955)</span>, Spencer <span class="citation">(Spencer 1987)</span> and Zelnik methods. Below we briefly give an overview of the method and apply them to the male Indian population in 1991.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DemoTools</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: Rcpp</span>

<span class="co"># 'pop1m_ind' available as package data</span>
<span class="va">Value</span> <span class="op">&lt;-</span> <span class="va">pop1m_ind</span>
<span class="va">Age</span>   <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Age</span>, <span class="va">Value</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>,
     ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Single age'</span>,
     main <span class="op">=</span> <span class="st">'Unsmoothed population'</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-1-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<div id="carrier-farrag" class="section level3">
<h3 class="hasAnchor">
<a href="#carrier-farrag" class="anchor"></a>Carrier-Farrag</h3>
<p>This method considers the ratio, <span class="math inline">\(K\)</span>, of the population in one five-year age-group to the next one <span class="citation">(Carrier and Farrag 1959)</span>. If <span class="math inline">\(v_0\)</span> is a ten-year age-group, and <span class="math inline">\(v_{-2}\)</span> and <span class="math inline">\(v_2\)</span> are the preceding and succeeding age-groups, respectively, and if <span class="math inline">\(K^4 = v_{-2}/v_2\)</span>. Then, the older five-year group <span class="math inline">\(v_1\)</span> can be estimated by <span class="math inline">\(v_0/(1+K)\)</span>. This equation connects the population in two ten-year age groups separated by an interval of ten years. Therefore the value <span class="math inline">\(K\)</span> can be seen as the middle point between the two ten-year age groups. To run this method in <code>DemoTools</code> the function <code>afesmth</code> is used with the option ‘Carrier-Farrag.’ The figure below shows the smoothed population by five-year age groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span>
  Value <span class="op">=</span> <span class="va">Value</span>,
  Age <span class="op">=</span> <span class="va">Age</span>,
  method <span class="op">=</span> <span class="st">"Carrier-Farrag"</span>,
  OAG <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">cf</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
     ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Carrier-Farrag'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-2-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="arriaga" class="section level3">
<h3 class="hasAnchor">
<a href="#arriaga" class="anchor"></a>Arriaga</h3>
<p>Similarly to the previous method, when the 10-year age group to be separates is the central group of three, the following formulas are used in this method <span class="citation">(Arriaga and others 1968)</span>:</p>
<p><span class="math display">\[\begin{equation*}
_{5}P_{x+5} = \frac{-_{10}P_{x-10}+11 _{10}P_{x+10}+2 _{10}P_{x+10}}{24}
\end{equation*}\]</span> and <span class="math display">\[\begin{equation*}
_{5}P_{x} = _{10}P_{x} - _{5}P_{x+5}
\end{equation*}\]</span></p>
<p>Where: <span class="math inline">\(_{5}P_{x+5}\)</span> is the population between ages <span class="math inline">\(x+5\)</span> and <span class="math inline">\(x+9\)</span>; <span class="math inline">\(_{10}P_{x}\)</span> is the population between ages <span class="math inline">\(x\)</span> and <span class="math inline">\(x+9\)</span>; and <span class="math inline">\(_{5}P_{x}\)</span> is the population between ages <span class="math inline">\(x+\)</span> and <span class="math inline">\(x+4\)</span>. When the 10-year age group to be separated is an extreme age group (the youngest or the oldest), the formulas are different. For the youngest age group, the following formulas are used:</p>
<p><span class="math display">\[\begin{equation*}
_{5}P_{x+5} = \frac{8 _{10}P_{x}+ 5 _{10}P_{x+10} - _{10}P_{x+20}}{24}
\end{equation*}\]</span> and <span class="math display">\[\begin{equation*}
_{5}P_{x} = _{10}P_{x} - _{5}P_{x+5}
\end{equation*}\]</span></p>
<p>and for the last age group the coefficients are reversed:</p>
<p><span class="math display">\[\begin{equation*}
_{5}P_{x} = \frac{ -_{10}P_{x-20}+ 5 _{10}P_{x-10}+ 8 _{10}P_{x}}{24}.
\end{equation*}\]</span></p>
<p>To perform this model the option ‘Arriaga’ must be chosen in the ‘agesmth’ function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span>
  Value <span class="op">=</span> <span class="va">Value</span>,
  Age <span class="op">=</span> <span class="va">Age</span>,
  method <span class="op">=</span> <span class="st">"Arriaga"</span>,
  OAG <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">cf</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
     ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Arriaga'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-3-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="karup-king-newton" class="section level3">
<h3 class="hasAnchor">
<a href="#karup-king-newton" class="anchor"></a>Karup-King-Newton</h3>
<p>Following the same logic, the KKN method uses the following formulas:</p>
<p><span class="math display">\[\begin{equation*}
_{5}P_{x} = \frac{1}{2} _{10}P_{x} + \frac{1}{16} \big( _{10}P_{x-10} - _{10}P_{x+10} \big)
\end{equation*}\]</span> and <span class="math display">\[\begin{equation*}
_{5}P_{x+5} = _{10}P_{x} - _{5}P_{x}.
\end{equation*}\]</span></p>
<p>To implement this smoothing process select the <code>KKN</code> in the <code>agesmth</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO smooth_age_5 is throwing an internal error</span>
<span class="co"># Error in tapply(Value, AgeN, sum) : arguments must have same length</span>

<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span>
  Value <span class="op">=</span> <span class="va">Value</span>,
  Age <span class="op">=</span> <span class="va">Age</span>,
  method <span class="op">=</span> <span class="st">"KKN"</span>,
  OAG <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">cf</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
     ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Karup-King-Newton '</span>,
     xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="united-nations" class="section level3">
<h3 class="hasAnchor">
<a href="#united-nations" class="anchor"></a>United Nations</h3>
<p>The United Nations <span class="citation">(Carrier and Farrag 1959)</span> developed the following formula to smooth population counts <span class="math display">\[\begin{equation}
_5\hat{P}_x = \frac{- _5P_{x-10} + 4\, _5P_{x-5} + 10\, _5P_{x} +4\, _5P_{x+5} - _5P_{x+10}}{16}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(_5\hat{P}_x\)</span> represents the smoothed population between ages <span class="math inline">\(x\)</span> and <span class="math inline">\(x+4\)</span>. This method can be applied in <code>DemoTools</code> using the <code>"United Nations</code> method of <code><a href="../reference/smooth_age_5.html">smooth_age_5()</a></code> as follows</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">un_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span>Value <span class="op">=</span> <span class="va">Value</span>,Age <span class="op">=</span> <span class="va">Age</span>,method<span class="op">=</span><span class="st">"United Nations"</span>,OAG <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">un_result</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">un_result</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
    ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with UN Method'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-5-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="strong" class="section level3">
<h3 class="hasAnchor">
<a href="#strong" class="anchor"></a>Strong</h3>
<p>The Strong formula adjusts proportionally the smoothed 10-year age groups to the census population in those ages, after this procedure the 10-year age groups can be subdivided into 5-year age groups <span class="citation">(Arriaga and others 1968)</span></p>
<p><span class="math display">\[\begin{equation}
_{10}\hat{P}_x = \frac{_{10}P_{x-10} + 2\, _10P_{x} + _{10}P_{x+10}}{4}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(_{10}\hat{P}_x\)</span> represents the smoothed population ages <span class="math inline">\(x\)</span> to <span class="math inline">\(x+9\)</span>. It is implemented in <code>DemoTools</code> as follows</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">strong_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span>Value <span class="op">=</span> <span class="va">Value</span>,Age <span class="op">=</span> <span class="va">Age</span>,method<span class="op">=</span><span class="st">"Strong"</span>,OAG <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">strong_result</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">strong_result</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
    ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Strong formula'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-6-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="zigzag" class="section level3">
<h3 class="hasAnchor">
<a href="#zigzag" class="anchor"></a>Zigzag</h3>
<p>The implementations of this methods assumes that persons incorrectly reported in peak age groups are evenly divided between the two adjacent age groups <span class="citation">(Feeney 2013)</span>. It relies in minimizing a measure of “roughness”: consider the difference <span class="math inline">\(R[i]\)</span> between the number of persons in the <span class="math inline">\(i\)</span>-th age group and the average of the numbers in adjacent age groups, <span class="math inline">\(R[i] = N[i] - (N[i -1] + N[i + 1])/2\)</span>. If the distribution displays zigzag, the <span class="math inline">\(R[i]\)</span> will relatively large. If the distribution is smooth, they will be relatively small. This suggests taking the sum of squares of these differences as the measure of roughness <span class="citation">(Feeney 2013)</span>. It can be implemented in <code>DemoTools</code> as follows</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">zz_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age_5.html">smooth_age_5</a></span><span class="op">(</span><span class="va">Value</span>, <span class="va">Age</span>, method <span class="op">=</span> <span class="st">"Zigzag"</span>,OAG <span class="op">=</span> <span class="cn">TRUE</span>, ageMin <span class="op">=</span> <span class="fl">0</span>, ageMax <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="va">zz_result</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">zz_result</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, type<span class="op">=</span> <span class="st">'l'</span>,
    ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Zig Zag formula'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>,<span class="st">'-'</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">104</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-7-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="polynomial" class="section level3">
<h3 class="hasAnchor">
<a href="#polynomial" class="anchor"></a>Polynomial</h3>
<p>A more general way is to smooth through linear models. Polynomial fitting is used to smooth data over age or time fitting linear models. It can be tweaked by changing the degree and by either log or power transforming and can be used on any age groups, including irregularly spaced, single age, or 5-year age groups. It can be implemented in <code>DemoTools</code> with the function <code>agesmth1</code> and the option <code>poly</code> as follows</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">poly_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agesmth1.html">agesmth1</a></span><span class="op">(</span><span class="va">Value</span>, <span class="va">Age</span>, method<span class="op">=</span><span class="st">"poly"</span>, OAG <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,<span class="va">poly_result</span>, type<span class="op">=</span> <span class="st">'l'</span>,
    ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with Poly formula'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,<span class="va">Value</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-8-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="loess" class="section level3">
<h3 class="hasAnchor">
<a href="#loess" class="anchor"></a>LOESS</h3>
<p>LOESS (locally weighted smoothing) helps to smooth data over age, preserving the open age group if necessary. It is a popular tool to create a smooth line through a timeplot or scatter plot. It can be tweaked by changing the degree and by either log or power transforming and can be used on any age groups, including irregularly spaced, single age, or 5-year age groups.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">loess_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agesmth1.html">agesmth1</a></span><span class="op">(</span><span class="va">Value</span>, <span class="va">Age</span>, method<span class="op">=</span><span class="st">"loess"</span>, OAG <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,<span class="va">loess_result</span>, type<span class="op">=</span> <span class="st">'l'</span>,
    ylab <span class="op">=</span> <span class="st">'Proportion of population'</span>,
     xlab <span class="op">=</span> <span class="st">'Age-group'</span>,main <span class="op">=</span> <span class="st">'Smoothed population with LOESS formula'</span>,xaxt<span class="op">=</span><span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,<span class="va">Value</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, labels <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span>, at <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="smoothing_with_demotools_files/figure-html/unnamed-chunk-9-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-arriaga1994population" class="csl-entry">
Arriaga, Eduardo E, Peter D Johnson, and Ellen Jamison. 1994. <em>Population Analysis with Microcomputers</em>. Vol. 1. Bureau of the Census.
</div>
<div id="ref-arriaga1968new" class="csl-entry">
Arriaga, Eduardo E, and others. 1968. <span>“New Life Tables for Latin American Populations in the Nineteenth and Twentieth Centuries.”</span> <em>New Life Tables for Latin American Populations in the Nineteenth and Twentieth Centuries.</em>, no. 3.
</div>
<div id="ref-carrier1959reduction" class="csl-entry">
Carrier, Norman H, and AM Farrag. 1959. <span>“The Reduction of Errors in Census Populations for Statistically Underdeveloped Countries.”</span> <em>Population Studies</em> 12 (3): 240–85.
</div>
<div id="ref-feeney2013" class="csl-entry">
Feeney, G. 2013. <span>“Removing "Zigzag" from Age Data.”</span> <em>White-Papers</em> 1 (1).
</div>
<div id="ref-siegel2004methods" class="csl-entry">
Siegel Jacob, S, and A Swanson David, eds. 2004. <em>The Methods and Materials of Demography</em>. 2nd ed. San Diego, USA: Elsevier Academic Press, California, USA.
</div>
<div id="ref-spencer1987improvements" class="csl-entry">
Spencer, G. 1987. <span>“Improvements in the Quality of Census Age Statistics for the Elderly”</span> 1: 3–1.
</div>
<div id="ref-united1955manual" class="csl-entry">
United Nations. 1955. <em>Manual II: Methods of Appraisal of Quality of Basic Data for Population Estimates</em>. 23. New York: United Nations Department of International Economic; Social Affairs.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tim Riffe, José Manuel Aburto, Ilya Kashnitsky, Monica Alexander, Marius D. Pascariu, Sara Hertog, Sean Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
