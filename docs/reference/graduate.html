<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Graduate grouped data — graduate • DemoTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Graduate grouped data — graduate" />
<meta property="og:description" content="A wrapper function for several graduation methods, primarily for count data (&quot;sprague&quot;, &quot;beers(ord)&quot;, &quot;beers(mod)&quot;, &quot;grabill&quot;, &quot;mono&quot; (Monotonic spline), &quot;uniform&quot;, &quot;pclm&quot;), but also with one (&quot;pclm&quot;) with an option for graduating rates if both event counts and population at risk are available." />
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-reverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">01.13.76</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Short manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Handle age heaping</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduate demographic counts</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smooth demographic counts</a>
    </li>
    <li>
      <a href="../articles/lifetables_with_demotools.html">Construct a lifetable</a>
    </li>
    <li>
      <a href="../articles/migration_with_demotools.html">Model migration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/case_study_1.html">Case study</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/timriffe1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/timriffe/DemoTools/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Graduate grouped data</h1>
    <small class="dont-index">Source: <a href='https://github.com/timriffe/DemoTools/blob/master/R/graduate.R'><code>R/graduate.R</code></a></small>
    <div class="hidden name"><code>graduate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper function for several graduation methods, primarily for count data (<code>"sprague"</code>, <code>"beers(ord)"</code>, <code>"beers(mod)"</code>, <code>"grabill"</code>, <code>"mono"</code> (Monotonic spline), <code>"uniform"</code>, <code>"pclm"</code>), but also with one (<code>"pclm"</code>) with an option for graduating rates if both event counts and population at risk are available.</p>
    </div>

    <pre class="usage"><span class='fu'>graduate</span><span class='op'>(</span>
  <span class='va'>Value</span>,
  <span class='va'>Age</span>,
  AgeInt <span class='op'>=</span> <span class='fu'><a href='age2int.html'>age2int</a></span><span class='op'>(</span><span class='va'>Age</span><span class='op'>)</span>,
  OAG <span class='op'>=</span> <span class='cn'>TRUE</span>,
  OAnew <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Age</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sprague"</span>, <span class='st'>"beers(ord)"</span>, <span class='st'>"beers(mod)"</span>, <span class='st'>"grabill"</span>, <span class='st'>"pclm"</span>, <span class='st'>"mono"</span>,
    <span class='st'>"uniform"</span><span class='op'>)</span>,
  keep0 <span class='op'>=</span> <span class='cn'>FALSE</span>,
  constrain <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Value</th>
      <td><p>numeric vector, presumably counts in grouped ages</p></td>
    </tr>
    <tr>
      <th>Age</th>
      <td><p>integer vector, lower bounds of age groups</p></td>
    </tr>
    <tr>
      <th>AgeInt</th>
      <td><p>integer vector, age interval widths</p></td>
    </tr>
    <tr>
      <th>OAG</th>
      <td><p>logical, default = <code>TRUE</code> is the final age group open?</p></td>
    </tr>
    <tr>
      <th>OAnew</th>
      <td><p>integer, optional new open age, higher than <code><a href='https://rdrr.io/r/base/Extremes.html'>max(Age)</a></code>. See details.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character, either <code>"sprague"</code>, <code>"beers(ord)")</code>, <code>"beers(mod)")</code>, <code>"mono")</code>, <code>"uniform")</code>, or <code>"pclm"</code></p></td>
    </tr>
    <tr>
      <th>keep0</th>
      <td><p>logical. Default <code>FALSE</code>. If available, should the value in the infant age group be maintained, and ages 1-4 constrained?</p></td>
    </tr>
    <tr>
      <th>constrain</th>
      <td><p>logical. Default <code>FALSE</code>. Should output be constrained to sum within the input age groups?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra arguments passed to <code><a href='graduate_beers.html'>graduate_beers()</a></code> or <code><a href='graduate_pclm.html'>graduate_pclm()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>"sprague"</code>, <code>"beers(ord)"</code>, <code>"beers(mod)"</code> methods require original data to be in uniform five-year age groups. If they are not (for example, the infant group is separate) then they are grouped to uniform width prior to splitting. If you want to keep the original infant count in output, then specify <code>keep0 = TRUE</code>. In this case, it is imputed, and ages 1-4 are rescaled, which may introduce a discontinuity in results from age 4 to 5. <code>keep0 = TRUE</code> may also be desired along with <code>method = "pclm"</code>.</p>
<p>Some methods are constrained, others not, and others are optionally constrained. If this is required, then this function can be followed up with <code><a href='rescaleAgeGroups.html'>rescaleAgeGroups()</a></code>, which may have the effect of breaking continuity in smooth results. This is inconsequential for downstream demography, but if this aesthetic side effect is undesired, then try one of the constrained methods: <code>"sprague"</code>, <code>"mono"</code>, <code>"pclm"</code> (with <code>control = list(lambda = 1/1e7) specified</code> or similar).</p>
<p>Beers may either be ordinary <code>"beers(ord)"</code> or modified <code>"beers(mod)"</code>, and either can pass on the optional argument <code>johnson = TRUE</code> if desired (this has a different distribution pattern for young ages, <code>FALSE</code> by default). If <code>method = "beers"</code> is given, then <code>"beers(ord)"</code> is used.</p>
<p>This wrapper standardizes some inconsistencies in how open ages are dealt with. For example, with the <code>"pclm"</code> method, the last age group can be redistributed over a specified interval implied by increase <code>OAnew</code> beyond the range of <code>Age</code>. To get this same behavior from <code>"mono"</code>, or <code>"uniform"</code> specify <code>OAG = FALSE</code> along with an appropriately high <code>OAnew</code> (or integer final value of <code>AgeInt</code>.</p>
<p><code>OAnew</code> cannot be higher than <code>max(Age)+4</code> for <code>"sprague"</code> or <code>"beers"</code> methods. For <code>"uniform","mono","pclm"</code> it can be higher than this, and in each case the open age group is completely redistributed within this range, meaning it's not really open anymore.</p>
<p>For all methods, negative values are detected in output. If present, we deal with these in the following way: we take the geometric mean between the given output (with negative imputed with 0s) and the output of <code><a href='graduate_mono.html'>graduate_mono()</a></code>, which is guaranteed non-negative. This only affects age groups where negatives were produced in the first pass. In our experience this only arises when using Sprague, Beers, or Grabill methods, whereas all others are guaranteed non-negative.</p>
<p>For any case where input data are in single ages, constraining results to sum to values in the original age groups will simply return the original input data, which is clearly not your intent. This might arise when using graduation as an implicit two-step smoother (group + graduate). In this case, separate the steps, first group using <code><a href='groupAges.html'>groupAges()</a></code> then use <code>graduate(..., constrain = TRUE)</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Pascariu MD, Dańko MJ, Schöley J, Rizzi S (2018).
&#8220;ungroup: An R package for efficient estimation of smooth distributions from coarsely binned data.&#8221;
<em>Age</em>, <b>10</b>, 0.

Rizzi S, Gampe J, Eilers PH (2015).
&#8220;Efficient estimation of smooth distributions from coarsely grouped data.&#8221;
<em>American journal of epidemiology</em>, <b>182</b>(2), 138--147.

Sprague TB (1880).
&#8220;Explanation of a new formula for interpolation.&#8221;
<em>Journal of the Institute of Actuaries</em>, <b>22</b>(4), 270--285.

Shryock HS, Siegel JS, Larmon EA (1973).
<em>The methods and materials of demography</em>.
US Bureau of the Census.

Siegel Jacob S, Swanson David A (eds.) (2004).
<em>The Methods and Materials of Demography</em>, 2 edition.
Elsevier Academic Press, California, USA, San Diego, USA.

Beers HS (1945).
&#8220;Modified-interpolation formulas that minimize fourth differences.&#8221;
<em>Record of the American Institute of Actuaries</em>, <b>34</b>(69), 14--20.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='graduate_sprague.html'>graduate_sprague</a></code>, <code><a href='graduate_beers.html'>graduate_beers</a></code>, <code><a href='graduate_uniform.html'>graduate_uniform</a></code>, <code><a href='graduate_mono.html'>graduate_mono</a></code>, <code><a href='graduate_pclm.html'>graduate_pclm</a></code>, <code><a href='graduate_grabill.html'>graduate_grabill</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>Value</span> <span class='op'>&lt;-</span> <span class='va'>pop5_mat</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>
<span class='va'>Value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10000</span>,<span class='fl'>44170</span>,<span class='va'>Value</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>Age</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"sprague"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 12172.4912 11380.4480 10717.4480 10171.0000  9728.6128  9377.7952  9106.0560 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8900.9040  8749.8480  8640.3968  8573.6144  8550.5648  8490.9808  8355.2608 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8171.5792  8008.3808  7852.7792  7694.2592  7534.6752  7373.9056  7210.8208 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7046.6624  6881.6064  6715.9664  6550.9440  6386.5216  6221.6160  6065.6560 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5922.9920  5789.2144  5656.4784  5527.4512  5393.8752  5251.2032  5103.9920 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4958.4544  4809.8784  4676.3904  4566.5184  4469.7584  4372.0480  4282.1632 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4161.7152  3992.0912  3793.9824  3600.3712  3397.0752  3237.6592  3149.6752 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3104.2192  3052.7728  3014.5648  2923.2688  2744.0448  2513.3488  2294.2640 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2064.3184  1897.9424  1835.3744  1836.1008  1826.9504  1831.6544  1779.1824 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1629.7344  1422.4784  1231.8448  1037.5024   891.8304   826.6464   813.1760 
#&gt;         70         71         72         73         74         75         76 
#&gt;   792.0960   776.7936   745.8176   683.0176   601.2752   529.6992   462.5600 
#&gt;         77         78         79         80         81         82         83 
#&gt;   401.2800   349.5120   304.9488   261.4336   219.9616   183.1696   151.6816 
#&gt;         84         85         86         87         88         89         90 
#&gt;   124.7536   100.7200    79.5568    61.8448    47.5888    36.2896    27.1456 
#&gt;         91         92         93         94         95         96         97 
#&gt;    19.9600    14.5360    10.5760     7.7824     5.8576     4.5040     3.4240 
#&gt;         98         99        100 
#&gt;     2.3200     0.8944     0.0000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"sprague"</span>, keep0<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 12172.4912 11380.4480 10717.4480 10171.0000  9728.6128  9377.7952  9106.0560 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8900.9040  8749.8480  8640.3968  8573.6144  8550.5648  8490.9808  8355.2608 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8171.5792  8008.3808  7852.7792  7694.2592  7534.6752  7373.9056  7210.8208 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7046.6624  6881.6064  6715.9664  6550.9440  6386.5216  6221.6160  6065.6560 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5922.9920  5789.2144  5656.4784  5527.4512  5393.8752  5251.2032  5103.9920 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4958.4544  4809.8784  4676.3904  4566.5184  4469.7584  4372.0480  4282.1632 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4161.7152  3992.0912  3793.9824  3600.3712  3397.0752  3237.6592  3149.6752 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3104.2192  3052.7728  3014.5648  2923.2688  2744.0448  2513.3488  2294.2640 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2064.3184  1897.9424  1835.3744  1836.1008  1826.9504  1831.6544  1779.1824 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1629.7344  1422.4784  1231.8448  1037.5024   891.8304   826.6464   813.1760 
#&gt;         70         71         72         73         74         75         76 
#&gt;   792.0960   776.7936   745.8176   683.0176   601.2752   529.6992   462.5600 
#&gt;         77         78         79         80         81         82         83 
#&gt;   401.2800   349.5120   304.9488   261.4336   219.9616   183.1696   151.6816 
#&gt;         84         85         86         87         88         89         90 
#&gt;   124.7536   100.7200    79.5568    61.8448    47.5888    36.2896    27.1456 
#&gt;         91         92         93         94         95         96         97 
#&gt;    19.9600    14.5360    10.5760     7.7824     5.8576     4.5040     3.4240 
#&gt;         98         99        100 
#&gt;     2.3200     0.8944     0.0000 </div><div class='input'>
<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(ord)"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 11932.7336 11342.3240 10788.6128 10280.2888  9826.0408  9435.4048  9117.0696 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8877.1824  8717.6544  8627.6888  8582.9336  8547.1760  8479.1200  8351.8720 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8180.8984  8008.1091  7852.8780  7694.6050  7534.7740  7373.6339  7210.9429 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7046.6180  6881.4510  6715.9220  6551.0661  6385.3171  6222.0540  6067.1890 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5923.4300  5788.0099  5657.7302  5526.9960  5392.2820  5250.7480  5105.2438 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4955.8375  4810.8300  4679.7210  4567.4700  4467.1415  4377.4523  4280.1980 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4154.8370  3990.1260  3799.3867  3592.6085  3399.8980  3247.5390  3152.4980 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3096.4565  3062.5760  3011.0000  2910.7920  2740.4800  2523.1520  2283.1606 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2068.3560  1912.0740  1839.4120  1824.9974  1837.8085  1827.7060  1765.3630 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1625.7860  1433.3365  1223.5134  1040.5320   902.4340   829.6760   804.8446 
#&gt;         70         71         72         73         74         75         76 
#&gt;   796.0879   775.3420   740.7370   681.5660   605.2671   528.8797   462.8580 
#&gt;         77         78         79         80         81         82         83 
#&gt;   402.3230   349.8100   304.1293   261.2455   220.0300   183.4090   151.7500 
#&gt;         84         85         86         87         88         89         90 
#&gt;   124.5655   100.6507    79.5820    61.9330    47.6140    36.2203    27.2401 
#&gt;         91         92         93         94         95         96         97 
#&gt;    20.1994    14.7124    10.4941     7.3540     5.1331     3.6913     2.8948 
#&gt;         98         99        100 
#&gt;     2.6035     2.6773     0.0000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(ord)"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 10000.0000 11861.3370 11282.2886 10750.7042 10275.6703  9435.4048  9117.0696 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8877.1824  8717.6544  8627.6888  8582.9336  8547.1760  8479.1200  8351.8720 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8180.8984  8008.1091  7852.8780  7694.6050  7534.7740  7373.6339  7210.9429 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7046.6180  6881.4510  6715.9220  6551.0661  6385.3171  6222.0540  6067.1890 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5923.4300  5788.0099  5657.7302  5526.9960  5392.2820  5250.7480  5105.2438 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4955.8375  4810.8300  4679.7210  4567.4700  4467.1415  4377.4523  4280.1980 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4154.8370  3990.1260  3799.3867  3592.6085  3399.8980  3247.5390  3152.4980 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3096.4565  3062.5760  3011.0000  2910.7920  2740.4800  2523.1520  2283.1606 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2068.3560  1912.0740  1839.4120  1824.9974  1837.8085  1827.7060  1765.3630 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1625.7860  1433.3365  1223.5134  1040.5320   902.4340   829.6760   804.8446 
#&gt;         70         71         72         73         74         75         76 
#&gt;   796.0879   775.3420   740.7370   681.5660   605.2671   528.8797   462.8580 
#&gt;         77         78         79         80         81         82         83 
#&gt;   402.3230   349.8100   304.1293   261.2455   220.0300   183.4090   151.7500 
#&gt;         84         85         86         87         88         89         90 
#&gt;   124.5655   100.6507    79.5820    61.9330    47.6140    36.2203    27.2401 
#&gt;         91         92         93         94         95         96         97 
#&gt;    20.1994    14.7124    10.4941     7.3540     5.1331     3.6913     2.8948 
#&gt;         98         99        100 
#&gt;     2.6035     2.6773     0.0000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(ord)"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span>, johnson <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 10000.0000 11342.3240 11462.1335 11023.6236 10341.9189  9651.0947  9097.9694 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8762.3499  8635.8972  8627.6888  8582.9336  8547.1760  8479.1200  8351.8720 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8180.8984  8008.1091  7852.8780  7694.6050  7534.7740  7373.6339  7210.9429 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7046.6180  6881.4510  6715.9220  6551.0661  6385.3171  6222.0540  6067.1890 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5923.4300  5788.0099  5657.7302  5526.9960  5392.2820  5250.7480  5105.2438 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4955.8375  4810.8300  4679.7210  4567.4700  4467.1415  4377.4523  4280.1980 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4154.8370  3990.1260  3799.3867  3592.6085  3399.8980  3247.5390  3152.4980 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3096.4565  3062.5760  3011.0000  2910.7920  2740.4800  2523.1520  2283.1606 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2068.3560  1912.0740  1839.4120  1824.9974  1837.8085  1827.7060  1765.3630 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1625.7860  1433.3365  1223.5134  1040.5320   902.4340   829.6760   804.8446 
#&gt;         70         71         72         73         74         75         76 
#&gt;   796.0879   775.3420   740.7370   681.5660   605.2671   528.8797   462.8580 
#&gt;         77         78         79         80         81         82         83 
#&gt;   402.3230   349.8100   304.1293   261.2455   220.0300   183.4090   151.7500 
#&gt;         84         85         86         87         88         89         90 
#&gt;   124.5655   100.6507    79.5820    61.9330    47.6140    36.2203    27.2401 
#&gt;         91         92         93         94         95         96         97 
#&gt;    20.1994    14.7124    10.4941     7.3540     5.1331     3.6913     2.8948 
#&gt;         98         99        100 
#&gt;     2.6035     2.6773     0.0000 </div><div class='input'>
<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(mod)"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 11952.2354 11325.4173 10766.2996 10274.8823  9851.1654  9494.3017  9201.8161 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8969.8051  8790.9099  8653.8682  8546.7035  8455.2302  8364.7480  8264.2114 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8146.8109  8009.2966  7855.8211  7697.9395  7537.0673  7374.4965  7210.6243 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7045.7255  6879.9525  6714.4613  6550.4634  6389.8558  6233.6499  6081.9715 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5935.0481  5792.5597  5653.0084  5514.9350  5376.9190  5238.6834  5100.5202 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4965.5251  4835.6769  4711.8375  4593.0579  4477.1996  4357.2582  4228.5099 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4088.5115  3937.6585  3778.8029  3621.7683  3474.4487  3342.8085  3227.5557 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3125.8698  3025.7427  2916.8358  2790.4800  2645.7098  2486.0157  2325.0249 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2175.3008  2048.3430  1946.4600  1866.9133  1796.7846  1722.9549  1632.1045 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1521.2719  1392.4311  1255.2308  1121.3870  1004.6830   909.3898   835.9914 
#&gt;         70         71         72         73         74         75         76 
#&gt;   780.7211   736.2617   691.7455   643.7115   590.5132   532.0976   471.0073 
#&gt;         77         78         79         80         81         82         83 
#&gt;   412.3805   357.4547   307.0949   261.9439   221.8201   185.7175   153.5851 
#&gt;         84         85         86         87         88         89         90 
#&gt;   125.2864   100.8658    80.1571    62.7835    48.3745    36.5281    26.8663 
#&gt;         91         92         93         94         95         96         97 
#&gt;    19.0789    12.9361     8.2390     4.8817     2.7712     1.8763     2.1907 
#&gt;         98         99        100 
#&gt;     3.7144     6.4474     0.0000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(mod)"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 10000.0000 11849.1277 11264.1552 10750.0138 10306.7033  9494.3017  9201.8161 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8969.8051  8790.9099  8653.8682  8546.7035  8455.2302  8364.7480  8264.2114 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8146.8109  8009.2966  7855.8211  7697.9395  7537.0673  7374.4965  7210.6243 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7045.7255  6879.9525  6714.4613  6550.4634  6389.8558  6233.6499  6081.9715 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5935.0481  5792.5597  5653.0084  5514.9350  5376.9190  5238.6834  5100.5202 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4965.5251  4835.6769  4711.8375  4593.0579  4477.1996  4357.2582  4228.5099 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4088.5115  3937.6585  3778.8029  3621.7683  3474.4487  3342.8085  3227.5557 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3125.8698  3025.7427  2916.8358  2790.4800  2645.7098  2486.0157  2325.0249 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2175.3008  2048.3430  1946.4600  1866.9133  1796.7846  1722.9549  1632.1045 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1521.2719  1392.4311  1255.2308  1121.3870  1004.6830   909.3898   835.9914 
#&gt;         70         71         72         73         74         75         76 
#&gt;   780.7211   736.2617   691.7455   643.7115   590.5132   532.0976   471.0073 
#&gt;         77         78         79         80         81         82         83 
#&gt;   412.3805   357.4547   307.0949   261.9439   221.8201   185.7175   153.5851 
#&gt;         84         85         86         87         88         89         90 
#&gt;   125.2864   100.8658    80.1571    62.7835    48.3745    36.5281    26.8663 
#&gt;         91         92         93         94         95         96         97 
#&gt;    19.0789    12.9361     8.2390     4.8817     2.7712     1.8763     2.1907 
#&gt;         98         99        100 
#&gt;     3.7144     6.4474     0.0000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"beers(mod)"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span>, johnson <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          0          1          2          3          4          5          6 
#&gt; 10000.0000 11325.4173 11441.7180 11025.7228 10377.1420  9717.5927  9184.3461 
#&gt;          7          8          9         10         11         12         13 
#&gt;  8850.5817  8704.3123  8653.8682  8546.7035  8455.2302  8364.7480  8264.2114 
#&gt;         14         15         16         17         18         19         20 
#&gt;  8146.8109  8009.2966  7855.8211  7697.9395  7537.0673  7374.4965  7210.6243 
#&gt;         21         22         23         24         25         26         27 
#&gt;  7045.7255  6879.9525  6714.4613  6550.4634  6389.8558  6233.6499  6081.9715 
#&gt;         28         29         30         31         32         33         34 
#&gt;  5935.0481  5792.5597  5653.0084  5514.9350  5376.9190  5238.6834  5100.5202 
#&gt;         35         36         37         38         39         40         41 
#&gt;  4965.5251  4835.6769  4711.8375  4593.0579  4477.1996  4357.2582  4228.5099 
#&gt;         42         43         44         45         46         47         48 
#&gt;  4088.5115  3937.6585  3778.8029  3621.7683  3474.4487  3342.8085  3227.5557 
#&gt;         49         50         51         52         53         54         55 
#&gt;  3125.8698  3025.7427  2916.8358  2790.4800  2645.7098  2486.0157  2325.0249 
#&gt;         56         57         58         59         60         61         62 
#&gt;  2175.3008  2048.3430  1946.4600  1866.9133  1796.7846  1722.9549  1632.1045 
#&gt;         63         64         65         66         67         68         69 
#&gt;  1521.2719  1392.4311  1255.2308  1121.3870  1004.6830   909.3898   835.9914 
#&gt;         70         71         72         73         74         75         76 
#&gt;   780.7211   736.2617   691.7455   643.7115   590.5132   532.0976   471.0073 
#&gt;         77         78         79         80         81         82         83 
#&gt;   412.3805   357.4547   307.0949   261.9439   221.8201   185.7175   153.5851 
#&gt;         84         85         86         87         88         89         90 
#&gt;   125.2864   100.8658    80.1571    62.7835    48.3745    36.5281    26.8663 
#&gt;         91         92         93         94         95         96         97 
#&gt;    19.0789    12.9361     8.2390     4.8817     2.7712     1.8763     2.1907 
#&gt;         98         99        100 
#&gt;     3.7144     6.4474     0.0000 </div><div class='input'>
<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"mono"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            0            1            2            3            4            5 
#&gt; 10000.000000 10850.481727 11280.016176 11257.267224 10782.234872  9965.472958 
#&gt;            6            7            8            9           10           11 
#&gt;  9249.196842  8743.960363  8449.763521  8366.606317  8447.848263  8506.927414 
#&gt;           12           13           14           15           16           17 
#&gt;  8497.203282  8418.675868  8271.345172  8069.013989  7866.893502  7678.786508 
#&gt;           18           19           20           21           22           23 
#&gt;  7504.693006  7344.612996  7195.295781  7043.738577  6886.690686  6724.152109 
#&gt;           24           25           26           27           28           29 
#&gt;  6556.122846  6385.146886  6221.400190  6067.426747  5923.226557  5788.799621 
#&gt;           30           31           32           33           34           35 
#&gt;  5661.452674  5530.412664  5392.986327  5249.173663  5098.974671  4946.090416 
#&gt;           36           37           38           39           40           41 
#&gt;  4805.325153  4680.379945  4571.254792  4477.949695  4392.929661  4286.054725 
#&gt;           42           43           44           45           46           47 
#&gt;  4149.789895  3984.135169  3789.090550  3576.638938  3394.711946  3255.292477 
#&gt;           48           49           50           51           52           53 
#&gt;  3158.380531  3103.976107  3076.530586  3013.849489  2900.384196  2736.134707 
#&gt;           54           55           56           57           58           59 
#&gt;  2521.101022  2273.886718  2068.906098  1924.762739  1841.456641  1818.987804 
#&gt;           60           61           62           63           64           65 
#&gt;  1838.178543  1822.318119  1752.228848  1627.910728  1449.363761  1233.631109 
#&gt;           66           67           68           69           70           71 
#&gt;  1048.885424   912.169870   823.484446   782.829152   779.113021   767.972184 
#&gt;           72           73           74           75           76           77 
#&gt;   738.315673   690.143490   623.455633   542.884808   466.961841   400.319437 
#&gt;           78           79           80           81           82           83 
#&gt;   342.957596   294.876318   254.979747   218.884453   185.494579   154.810127 
#&gt;           84           85           86           87           88           89 
#&gt;   126.831094   101.692205    79.932348    61.686245    46.953897    35.735304 
#&gt;           90           91           92           93           94           95 
#&gt;    27.603433    20.850155    15.048439    10.198284     6.299690     3.438064 
#&gt;           96           97           98           99          100 
#&gt;     1.955032     1.936000     3.380968     6.289936     0.000000 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"mono"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            0            1            2            3            4            5 
#&gt; 10000.000000 10850.481727 11280.016176 11257.267224 10782.234872  9965.472958 
#&gt;            6            7            8            9           10           11 
#&gt;  9249.196842  8743.960363  8449.763521  8366.606317  8447.848263  8506.927414 
#&gt;           12           13           14           15           16           17 
#&gt;  8497.203282  8418.675868  8271.345172  8069.013989  7866.893502  7678.786508 
#&gt;           18           19           20           21           22           23 
#&gt;  7504.693006  7344.612996  7195.295781  7043.738577  6886.690686  6724.152109 
#&gt;           24           25           26           27           28           29 
#&gt;  6556.122846  6385.146886  6221.400190  6067.426747  5923.226557  5788.799621 
#&gt;           30           31           32           33           34           35 
#&gt;  5661.452674  5530.412664  5392.986327  5249.173663  5098.974671  4946.090416 
#&gt;           36           37           38           39           40           41 
#&gt;  4805.325153  4680.379945  4571.254792  4477.949695  4392.929661  4286.054725 
#&gt;           42           43           44           45           46           47 
#&gt;  4149.789895  3984.135169  3789.090550  3576.638938  3394.711946  3255.292477 
#&gt;           48           49           50           51           52           53 
#&gt;  3158.380531  3103.976107  3076.530586  3013.849489  2900.384196  2736.134707 
#&gt;           54           55           56           57           58           59 
#&gt;  2521.101022  2273.886718  2068.906098  1924.762739  1841.456641  1818.987804 
#&gt;           60           61           62           63           64           65 
#&gt;  1838.178543  1822.318119  1752.228848  1627.910728  1449.363761  1233.631109 
#&gt;           66           67           68           69           70           71 
#&gt;  1048.885424   912.169870   823.484446   782.829152   779.113021   767.972184 
#&gt;           72           73           74           75           76           77 
#&gt;   738.315673   690.143490   623.455633   542.884808   466.961841   400.319437 
#&gt;           78           79           80           81           82           83 
#&gt;   342.957596   294.876318   254.979747   218.884453   185.494579   154.810127 
#&gt;           84           85           86           87           88           89 
#&gt;   126.831094   101.692205    79.932348    61.686245    46.953897    35.735304 
#&gt;           90           91           92           93           94           95 
#&gt;    27.603433    20.850155    15.048439    10.198284     6.299690     3.438064 
#&gt;           96           97           98           99          100 
#&gt;     1.955032     1.936000     3.380968     6.289936     0.000000 </div><div class='input'>
<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"uniform"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       0       1       2       3       4       5       6       7       8       9 
#&gt; 10000.0 11042.5 11042.5 11042.5 11042.5  8955.0  8955.0  8955.0  8955.0  8955.0 
#&gt;      10      11      12      13      14      15      16      17      18      19 
#&gt;  8428.4  8428.4  8428.4  8428.4  8428.4  7692.8  7692.8  7692.8  7692.8  7692.8 
#&gt;      20      21      22      23      24      25      26      27      28      29 
#&gt;  6881.2  6881.2  6881.2  6881.2  6881.2  6077.2  6077.2  6077.2  6077.2  6077.2 
#&gt;      30      31      32      33      34      35      36      37      38      39 
#&gt;  5386.6  5386.6  5386.6  5386.6  5386.6  4696.2  4696.2  4696.2  4696.2  4696.2 
#&gt;      40      41      42      43      44      45      46      47      48      49 
#&gt;  4120.4  4120.4  4120.4  4120.4  4120.4  3297.8  3297.8  3297.8  3297.8  3297.8 
#&gt;      50      51      52      53      54      55      56      57      58      59 
#&gt;  2849.6  2849.6  2849.6  2849.6  2849.6  1985.6  1985.6  1985.6  1985.6  1985.6 
#&gt;      60      61      62      63      64      65      66      67      68      69 
#&gt;  1698.0  1698.0  1698.0  1698.0  1698.0   960.2   960.2   960.2   960.2   960.2 
#&gt;      70      71      72      73      74      75      76      77      78      79 
#&gt;   719.8   719.8   719.8   719.8   719.8   409.6   409.6   409.6   409.6   409.6 
#&gt;      80      81      82      83      84      85      86      87      88      89 
#&gt;   188.2   188.2   188.2   188.2   188.2    65.2    65.2    65.2    65.2    65.2 
#&gt;      90      91      92      93      94      95      96      97      98      99 
#&gt;    16.0    16.0    16.0    16.0    16.0     3.4     3.4     3.4     3.4     3.4 
#&gt;     100 
#&gt;     0.0 </div><div class='input'>
<span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"pclm"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 0s detected in Value, replacing with .01</div><div class='output co'>#&gt;            0            1            2            3            4            5 
#&gt; 10022.215013 10787.284952 11254.927495 11275.878141 10807.945737 10074.820067 
#&gt;            6            7            8            9           10           11 
#&gt;  9328.990796  8736.954126  8394.295366  8273.423000  8318.186994  8432.063491 
#&gt;           12           13           14           15           16           17 
#&gt;  8510.161955  8497.041470  8366.763507  8151.826000  7903.088751  7662.043415 
#&gt;           18           19           20           21           22           23 
#&gt;  7459.549206  7296.415870  7161.468953  7035.158379  6896.994675  6740.483732 
#&gt;           24           25           26           27           28           29 
#&gt;  6566.732244  6387.046021  6215.809887  6060.718142  5925.006272  5801.820878 
#&gt;           30           31           32           33           34           35 
#&gt;  5679.677222  5548.087900  5398.664503  5234.736788  5066.280979  4908.166239 
#&gt;           36           37           38           39           40           41 
#&gt;  4776.279043  4674.568329  4598.978894  4531.953370  4447.596301  4325.842633 
#&gt;           42           43           44           45           46           47 
#&gt;  4153.829634  3942.404051  3717.819885  3511.257711  3353.616522  3254.024393 
#&gt;           48           49           50           51           52           53 
#&gt;  3206.437472  3185.637396  3149.057772  3061.485892  2899.842199  2676.396203 
#&gt;           54           55           56           57           58           59 
#&gt;  2430.918221  2205.098826  2036.292267  1935.380958  1895.250695  1894.349683 
#&gt;           60           61           62           63           64           65 
#&gt;  1891.968479  1851.208654  1745.246502  1577.503188  1381.551771  1192.259170 
#&gt;           66           67           68           69           70           71 
#&gt;  1038.630147   929.284819   859.268152   818.952155   792.502498   766.383285 
#&gt;           72           73           74           75           76           77 
#&gt;   729.250203   676.034500   610.317889   538.451097   468.334362   404.620404 
#&gt;           78           79           80           81           82           83 
#&gt;   348.592969   299.925248   257.029245   218.669115   184.007169   152.690106 
#&gt;           84           85           86           87           88           89 
#&gt;   124.764414   100.308814    79.376504    61.864847    47.546364    36.083333 
#&gt;           90           91           92           93           94           95 
#&gt;    27.083527    20.136500    14.849153    10.872898     7.911233     5.723911 
#&gt;           96           97           98           99          100 
#&gt;     4.120705     2.953872     2.110491     1.504532     1.071260 </div><div class='input'><span class='fu'>graduate</span><span class='op'>(</span><span class='va'>Value</span>, <span class='va'>Age</span>, method <span class='op'>=</span> <span class='st'>"pclm"</span>, keep0<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 0s detected in Value, replacing with .01</div><div class='output co'>#&gt;            0            1            2            3            4            5 
#&gt; 10000.000000 10798.032545 11266.141010 11287.112529 10818.713915 10074.820067 
#&gt;            6            7            8            9           10           11 
#&gt;  9328.990796  8736.954126  8394.295366  8273.423000  8318.186994  8432.063491 
#&gt;           12           13           14           15           16           17 
#&gt;  8510.161955  8497.041470  8366.763507  8151.826000  7903.088751  7662.043415 
#&gt;           18           19           20           21           22           23 
#&gt;  7459.549206  7296.415870  7161.468953  7035.158379  6896.994675  6740.483732 
#&gt;           24           25           26           27           28           29 
#&gt;  6566.732244  6387.046021  6215.809887  6060.718142  5925.006272  5801.820878 
#&gt;           30           31           32           33           34           35 
#&gt;  5679.677222  5548.087900  5398.664503  5234.736788  5066.280979  4908.166239 
#&gt;           36           37           38           39           40           41 
#&gt;  4776.279043  4674.568329  4598.978894  4531.953370  4447.596301  4325.842633 
#&gt;           42           43           44           45           46           47 
#&gt;  4153.829634  3942.404051  3717.819885  3511.257711  3353.616522  3254.024393 
#&gt;           48           49           50           51           52           53 
#&gt;  3206.437472  3185.637396  3149.057772  3061.485892  2899.842199  2676.396203 
#&gt;           54           55           56           57           58           59 
#&gt;  2430.918221  2205.098826  2036.292267  1935.380958  1895.250695  1894.349683 
#&gt;           60           61           62           63           64           65 
#&gt;  1891.968479  1851.208654  1745.246502  1577.503188  1381.551771  1192.259170 
#&gt;           66           67           68           69           70           71 
#&gt;  1038.630147   929.284819   859.268152   818.952155   792.502498   766.383285 
#&gt;           72           73           74           75           76           77 
#&gt;   729.250203   676.034500   610.317889   538.451097   468.334362   404.620404 
#&gt;           78           79           80           81           82           83 
#&gt;   348.592969   299.925248   257.029245   218.669115   184.007169   152.690106 
#&gt;           84           85           86           87           88           89 
#&gt;   124.764414   100.308814    79.376504    61.864847    47.546364    36.083333 
#&gt;           90           91           92           93           94           95 
#&gt;    27.083527    20.136500    14.849153    10.872898     7.911233     5.723911 
#&gt;           96           97           98           99          100 
#&gt;     4.120705     2.953872     2.110491     1.504532     1.071260 </div><div class='input'><span class='co'># pclm can also graduate rates if both</span>
<span class='co'># numerators and denominators are on hand:</span>
<span class='va'>Exposures</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100958</span>,<span class='fl'>466275</span>,<span class='fl'>624134</span>,<span class='fl'>559559</span>,<span class='fl'>446736</span>,<span class='fl'>370653</span>,<span class='fl'>301862</span>,<span class='fl'>249409</span>,
               <span class='fl'>247473</span>,<span class='fl'>223014</span>,<span class='fl'>172260</span>,<span class='fl'>149338</span>,<span class='fl'>127242</span>,<span class='fl'>105715</span>,<span class='fl'>79614</span>,<span class='fl'>53660</span>,
               <span class='fl'>31021</span>,<span class='fl'>16805</span>,<span class='fl'>8000</span>,<span class='fl'>4000</span>,<span class='fl'>2000</span>,<span class='fl'>1000</span><span class='op'>)</span>

<span class='va'>Deaths</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8674</span>,<span class='fl'>1592</span>,<span class='fl'>618</span>,<span class='fl'>411</span>,<span class='fl'>755</span>,<span class='fl'>1098</span>,<span class='fl'>1100</span>,<span class='fl'>1357</span>,
            <span class='fl'>1335</span>,<span class='fl'>3257</span>,<span class='fl'>2200</span>,<span class='fl'>4023</span>,<span class='fl'>2167</span>,<span class='fl'>4578</span>,<span class='fl'>2956</span>,<span class='fl'>4212</span>,
            <span class='fl'>2887</span>,<span class='fl'>2351</span>,<span class='fl'>1500</span>,<span class='fl'>900</span>,<span class='fl'>500</span>,<span class='fl'>300</span><span class='op'>)</span>
<span class='va'>Age</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>100</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>AgeInt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>Age</span><span class='op'>)</span>, <span class='cn'>NA</span><span class='op'>)</span>

<span class='co'># exclude infants for better fit.</span>
<span class='va'>mx</span>    <span class='op'>&lt;-</span> <span class='fu'>graduate</span><span class='op'>(</span>
           Value <span class='op'>=</span> <span class='va'>Deaths</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, Age <span class='op'>=</span> <span class='va'>Age</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
           AgeInt <span class='op'>=</span> <span class='va'>AgeInt</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, OAG <span class='op'>=</span> <span class='cn'>TRUE</span>,
           OAnew <span class='op'>=</span> <span class='fl'>110</span>, offset <span class='op'>=</span> <span class='va'>Exposures</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
           method <span class='op'>=</span> <span class='st'>"pclm"</span><span class='op'>)</span>
<span class='va'>mx_sm</span> <span class='op'>&lt;-</span> <span class='fu'>graduate</span><span class='op'>(</span>
           Value <span class='op'>=</span> <span class='va'>Deaths</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, Age <span class='op'>=</span> <span class='va'>Age</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
           AgeInt <span class='op'>=</span> <span class='va'>AgeInt</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, OAG <span class='op'>=</span> <span class='cn'>TRUE</span>,
           OAnew <span class='op'>=</span> <span class='fl'>110</span>, offset <span class='op'>=</span> <span class='va'>Exposures</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
           method <span class='op'>=</span> <span class='st'>"pclm"</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambda <span class='op'>=</span> <span class='fl'>1e7</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Age</span>,
     <span class='va'>Deaths</span> <span class='op'>/</span> <span class='va'>Exposures</span>,
     type <span class='op'>=</span> <span class='st'>'s'</span>, log <span class='op'>=</span> <span class='st'>'y'</span>,
     main <span class='op'>=</span> <span class='st'>"Underlying data have differential heaping on 0s and 5s"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>110</span>, <span class='va'>mx</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>110</span>, <span class='va'>mx_sm</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"bottomright"</span>,
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"black"</span>,<span class='st'>"blue"</span><span class='op'>)</span>,
       lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
       legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lambda optimized (almost constrained)"</span>,
                  <span class='st'>"higher lambda = smoother"</span><span class='op'>)</span>
       <span class='op'>)</span>
  <span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Riffe, José Manuel Aburto, Ilya Kashnitsky, Monica Alexander, Marius D. Pascariu, Sara Hertog, Sean Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


