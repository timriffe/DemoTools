<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Split age groups using a monotonic spline. — splitMono • DemoTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Split age groups using a monotonic spline. — splitMono" />
<meta property="og:description" content="Take the cumulative sum of Value and then run a monotonic spline through it. The first differences split back single-age estimates of Value. Optionally keep the open age group untouched." />
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Age-heaping indices with DemoTools</a>
    </li>
    <li>
      <a href="../articles/case_study_1.html">DemoTools: A case study</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduation with DemoTools</a>
    </li>
    <li>
      <a href="../articles/lifetable_with_demotools.html">The lifetable with DemoTools</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smoothing with DemoTools</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Split age groups using a monotonic spline.</h1>
    
    <div class="hidden name"><code>splitMono.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Take the cumulative sum of <code>Value</code> and then run a monotonic spline through it. The first differences split back single-age estimates of <code>Value</code>. Optionally keep the open age group untouched.</p>
    </div>

    <pre class="usage"><span class='fu'>splitMono</span>(<span class='no'>Value</span>, <span class='no'>AgeInt</span>, <span class='no'>Age</span>, <span class='kw'>OAG</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Value</th>
      <td><p>numeric. Vector of (presumably) counts in grouped ages.</p></td>
    </tr>
    <tr>
      <th>AgeInt</th>
      <td><p>integer or numeric. Vector of age intervals.</p></td>
    </tr>
    <tr>
      <th>Age</th>
      <td><p>numeric. Vector of ages corresponding to the lower integer bound of the age range.</p></td>
    </tr>
    <tr>
      <th>OAG</th>
      <td><p>boolean. Argument that determines whether the final age group (assumed open ended) is kept as it is or has the same length as the rest of the age groups. Default is FALSE, i.e. use the same length for the final age group.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Numeric. vector of single smoothed age counts.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>"monoH.FC"</code> method of <code><a href='https://rdrr.io/r/stats/splinefun.html'>stats::splinefun()</a></code> is used to fit the spline because 1) it passes exactly through the points, 2) it is monotonic and therefore guarantees positive counts, and 3) it seems to be a bit less wiggly (lower average first differences of split counts). Single-age data is returned as-is. If you want to use this function as a smoother you first need to group to non-single ages.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fritsch FN, Carlson RE (1980).
&#8220;Monotone piecewise cubic interpolation.&#8221;
<em>SIAM Journal on Numerical Analysis</em>, <b>17</b>(2), 238--246.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>Value</span>                <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>88623</span>, <span class='fl'>90842</span>, <span class='fl'>93439</span>, <span class='fl'>96325</span>, <span class='fl'>99281</span>, <span class='fl'>102051</span>, <span class='fl'>104351</span>,
                         <span class='fl'>106555</span>, <span class='fl'>109170</span>, <span class='fl'>112188</span>, <span class='fl'>113582</span>, <span class='fl'>112614</span>, <span class='fl'>108904</span>, <span class='fl'>102622</span>, <span class='fl'>95867</span>,
                         <span class='fl'>80874</span>, <span class='fl'>60196</span>, <span class='fl'>37523</span>, <span class='fl'>17927</span>, <span class='fl'>5642</span>, <span class='fl'>1110</span>), <span class='kw'>.Names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"0"</span>, <span class='st'>"5"</span>,
                         <span class='st'>"10"</span>, <span class='st'>"15"</span>, <span class='st'>"20"</span>, <span class='st'>"25"</span>, <span class='st'>"30"</span>, <span class='st'>"35"</span>, <span class='st'>"40"</span>, <span class='st'>"45"</span>, <span class='st'>"50"</span>, <span class='st'>"55"</span>, <span class='st'>"60"</span>,
                         <span class='st'>"65"</span>, <span class='st'>"70"</span>, <span class='st'>"75"</span>, <span class='st'>"80"</span>, <span class='st'>"85"</span>, <span class='st'>"90"</span>, <span class='st'>"95"</span>, <span class='st'>"100"</span>))

<span class='co'># overwrite open age group with a single age estimate for that age</span>
<span class='co'># (doesn't extrapolate)</span>
<span class='fu'>splitMono</span>(<span class='no'>Value</span>)</div><div class='output co'>#&gt;         0         1         2         3         4         5         6         7 
#&gt; 17689.096 17653.592 17671.344 17742.352 17866.616 17984.832 18067.544 18159.328 
#&gt;         8         9        10        11        12        13        14        15 
#&gt; 18260.184 18370.112 18475.416 18574.672 18680.864 18793.992 18914.056 19033.000 
#&gt;        16        17        18        19        20        21        22        23 
#&gt; 19147.320 19263.320 19381.000 19500.360 19622.696 19743.912 19860.664 19972.952 
#&gt;        24        25        26        27        28        29        30        31 
#&gt; 20080.776 20196.120 20314.440 20421.480 20517.240 20601.720 20687.736 20781.272 
#&gt;        32        33        34        35        36        37        38        39 
#&gt; 20872.504 20961.432 21048.056 21128.104 21209.688 21301.136 21402.448 21513.624 
#&gt;        40        41        42        43        44        45        46        47 
#&gt; 21618.352 21716.504 21824.328 21941.824 22068.992 22222.144 22368.848 22476.576 
#&gt;        48        49        50        51        52        53        54        55 
#&gt; 22545.328 22575.104 22642.672 22736.224 22773.088 22753.264 22676.752 22644.112 
#&gt;        56        57        58        59        60        61        62        63 
#&gt; 22649.264 22588.608 22462.144 22269.872 22118.752 22011.504 21842.528 21611.824 
#&gt;        64        65        66        67        68        69        70        71 
#&gt; 21319.392 21034.528 20790.816 20535.752 20269.336 19991.568 19845.608 19707.216 
#&gt;        72        73        74        75        76        77        78        79 
#&gt; 19371.112 18837.296 18105.768 17465.200 16956.440 16311.240 15529.600 14611.520 
#&gt;        80        81        82        83        84        85        86        87 
#&gt; 13725.360 12930.160 12087.080 11196.120 10257.280  9269.208  8313.056  7430.752 
#&gt;        88        89        90        91        92        93        94        95 
#&gt;  6622.296  5887.688  5036.104  4135.288  3409.936  2860.048  2485.624  1987.152 
#&gt;        96        97        98        99       100       101       102       103 
#&gt;  1371.704   942.328   699.024   641.792   512.048   258.256   113.232    76.976 
#&gt;       104 
#&gt;   149.488 </div><div class='input'><span class='co'># or respect open age group</span>
<span class='fu'>splitMono</span>(<span class='no'>Value</span>, <span class='kw'>OAG</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;         0         1         2         3         4         5         6         7 
#&gt; 17689.096 17653.592 17671.344 17742.352 17866.616 17984.832 18067.544 18159.328 
#&gt;         8         9        10        11        12        13        14        15 
#&gt; 18260.184 18370.112 18475.416 18574.672 18680.864 18793.992 18914.056 19033.000 
#&gt;        16        17        18        19        20        21        22        23 
#&gt; 19147.320 19263.320 19381.000 19500.360 19622.696 19743.912 19860.664 19972.952 
#&gt;        24        25        26        27        28        29        30        31 
#&gt; 20080.776 20196.120 20314.440 20421.480 20517.240 20601.720 20687.736 20781.272 
#&gt;        32        33        34        35        36        37        38        39 
#&gt; 20872.504 20961.432 21048.056 21128.104 21209.688 21301.136 21402.448 21513.624 
#&gt;        40        41        42        43        44        45        46        47 
#&gt; 21618.352 21716.504 21824.328 21941.824 22068.992 22222.144 22368.848 22476.576 
#&gt;        48        49        50        51        52        53        54        55 
#&gt; 22545.328 22575.104 22642.672 22736.224 22773.088 22753.264 22676.752 22644.112 
#&gt;        56        57        58        59        60        61        62        63 
#&gt; 22649.264 22588.608 22462.144 22269.872 22118.752 22011.504 21842.528 21611.824 
#&gt;        64        65        66        67        68        69        70        71 
#&gt; 21319.392 21034.528 20790.816 20535.752 20269.336 19991.568 19845.608 19707.216 
#&gt;        72        73        74        75        76        77        78        79 
#&gt; 19371.112 18837.296 18105.768 17465.200 16956.440 16311.240 15529.600 14611.520 
#&gt;        80        81        82        83        84        85        86        87 
#&gt; 13725.360 12930.160 12087.080 11196.120 10257.280  9269.208  8313.056  7430.752 
#&gt;        88        89        90        91        92        93        94        95 
#&gt;  6622.296  5887.688  5036.104  4135.288  3409.936  2860.048  2485.624  1914.640 
#&gt;        96        97        98        99       100 
#&gt;  1226.680   833.560   735.280   931.840  1110.000 </div><div class='input'>
<span class='co'># Also accepts single ages:</span>
<span class='no'>Value</span>                <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span>(<span class='no'>pop1m_ind</span>, <span class='kw'>.Names</span> <span class='kw'>=</span> <span class='fl'>0</span>:<span class='fl'>100</span>)

                <span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
        <span class='no'>ages</span>                <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>100</span>,<span class='fl'>5</span>)
 <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>splitMono</span>(<span class='no'>Value</span>),<span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>'Age'</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>'Counts'</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>,<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>'Ungrouped counts'</span>)
                }</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Riffe, Sean Fennell, José Manuel Aburto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


